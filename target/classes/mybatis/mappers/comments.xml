<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="comments">

<insert id="insertInComments" parameterType="com.javaex.vo.CommentsVo">
<selectKey keyProperty="cmtNo" resultType="int" order="BEFORE">
	select Seq_comments_No.Nextval from dual
	</selectKey>
<![CDATA[

insert into comments values (
        #{cmtNo},
        #{postNo},
        #{userNo},
        #{cmtContent},
        sysdate
)

]]>
</insert>

<select id="selectByCmtNo" parameterType="int" resultType="com.javaex.vo.CommentsVo">
<![CDATA[
select  
        u.username as userName,
        c.cmtNo as cmtNo,
        c.postNo as postNo,
        c.userNo as userNo,
        c.cmtContent as cmtContent,
        c.regDate as regDate
from comments c join users u 
on u.userno = c.userno
where cmtNo = #{cmtNo}

]]>
</select>

<select id="selectList"  parameterType="int" resultType="com.javaex.vo.CommentsVo">
<![CDATA[
select  
        u.username as userName,
        c.cmtNo as cmtNo,
        c.postNo as postNo,
        c.userNo as userNo,
        c.cmtContent as cmtContent,
        c.regDate as regDate
from comments c join users u 
on u.userno = c.userno
where postNo = #{postNo}
order by cmtNo desc

]]>
</select>

</mapper>